(globalThis.webpackChunktajmr=globalThis.webpackChunktajmr||[]).push([[389],{9666:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>be});var n=r(7294),a=r(5697),s=r.n(a),i=r(7703),o=r(8391),l=r(4184),c=r.n(l),m=r(5615),p=r(1657),u=r(9859);function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const h="notwork";class f extends n.Component{constructor(...e){super(...e),d(this,"state",{referenceDate:new Date,filterOut:[]}),d(this,"toggleFilter",(e=>{this.state.filterOut.includes(e)?this.setState((t=>({filterOut:t.filterOut.filter((t=>t!==e))}))):this.setState((t=>({filterOut:[...t.filterOut,e]})))})),d(this,"lastMonth",(()=>{const{referenceDate:e}=this.state,t=new Date(e);t.setMonth(e.getMonth()-1),this.setState({referenceDate:t})})),d(this,"nextMonth",(()=>{const{referenceDate:e}=this.state,t=new Date(e);t.setMonth(e.getMonth()+1),this.setState({referenceDate:t})})),d(this,"getGroupedIntervalsBy",(e=>this.getMonthIntervals().reduce(((t,r)=>{let n=r[e]?r[e].toLowerCase():"-";return r.notWork&&(n=`notwork:${n}`),t[n]||(t[n]=0),t[n]+=(r.endTime||Date.now())-r.startTime,t}),{}))),d(this,"getMonthIntervals",(()=>{const{referenceDate:e}=this.state,{intervals:t}=this.props,{startTime:r,endTime:n}=(0,u.jw)(e);return t.filter((e=>e.startTime>r&&e.startTime<=n))}))}render(){const{referenceDate:e,filterOut:t}=this.state,{className:r}=this.props,a=this.getGroupedIntervalsBy("note"),s=Object.keys(a).map((e=>e.toLowerCase())),i=s.filter((e=>!t.includes(e))),o=i.reduce(((e,t)=>e+a[t]),0);return n.createElement("div",{className:c()("MonthReport",r)},n.createElement("h2",{className:"MonthReport__title"},"Månadssammanställning"),n.createElement("h3",{className:"MonthReport__subtitle"},n.createElement(m.Z,{onClick:this.lastMonth},"◀︎"),`${u.e7[e.getMonth()]} ${e.getFullYear()}`,n.createElement(m.Z,{onClick:this.nextMonth},"▶︎")),n.createElement("div",{className:"MonthReport__filters"},s.map((e=>n.createElement(m.Z,{className:c()("MonthReport__filter",{"MonthReport__filter--active":i.includes(e)}),key:e,onClick:()=>this.toggleFilter(e)},e)))),n.createElement("ul",{className:"MonthReport__list"},i.map((e=>n.createElement("li",{key:e,className:c()("MonthReport__list-item",{"not-work":e.startsWith(h)})},n.createElement("p",{className:"MonthReport__list-item__title"},e),n.createElement("p",{className:"MonthReport__list-item__value"},`${(0,u.pD)(a[e]).toFixed(1)}h`)))),n.createElement("li",{className:"MonthReport__list-item"},n.createElement("p",{className:"MonthReport__list-item__title"},"TOTAL:"),n.createElement("p",{className:"MonthReport__list-item__value"},`${(0,u.pD)(o).toFixed(1)}h`))))}}f.propTypes={className:s().string,intervals:p.FC.isRequired};const v=f;function b(e){return e.displayName||e.name||"Component"}const g=3e4;function y(e){if(!e||"number"!=typeof e)throw Error("Argument for render interval must be number");return t=>{class r extends n.Component{componentDidMount(){this.intervalId=setInterval((()=>{this.forceUpdate()}),e)}componentWillUnmount(){clearInterval(this.intervalId)}render(){return n.createElement(t,this.props)}}return r.getDisplayName=b(t),r}}var k=r(3635),w=r.n(k);const E=({from:e,elapsed:t})=>{const r=e?Date.now()-e+t:t,{hours:a,minutes:s}=(0,u.Ds)(r),i=(0,u.u6)(r,{isDuration:!0});return e&&a&&0===s&&w()(`Nu har du jobbat i ${a} timmar.`),n.createElement("div",{className:"digital-clock"},n.createElement("time",null,i))};E.propTypes={elapsed:s().number.isRequired,from:s().number.isRequired};const O=y(g)(E);function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function T(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const D=e=>{let{isLoading:t=!1,activeInterval:r,onClick:a}=e,s=T(e,["isLoading","activeInterval","onClick"]);const i=r?"Ta en fika ▐▐":"Börja debitera ▶";return n.createElement(m.Z,_({},s,{theme:"primary",className:"work-button",onClick:a,text:i,disabled:t}))};D.propTypes={activeInterval:s().bool.isRequired,onClick:s().func.isRequired,isLoading:s().bool};const N=D;function j(e){return Math.round(10*e)/10}const R=({progress:e,max:t,onlyDelta:r,unit:a=""})=>{const s=(e/t).toFixed(2),i=s>1,o=i?1/s*100+"%":100*s+"%",l=i?100*(1-1/s)+"%":100*(1-s)+"%",m=j(Math.abs(t-e)),p=c()("progress-bar",{"progress-bar--only-delta":r}),u=[e,t].map(j).join(" / ");return n.createElement("div",{className:p},n.createElement("div",{style:{flexBasis:o},className:"progress-bar__progress"}),n.createElement("div",{style:{flexBasis:l},className:c()("progress-bar__rest",{"progress-bar__overtime":i})}),n.createElement("div",{className:"progress-bar__text"},n.createElement("span",{className:"progress-bar__text__progress"},u),!!m&&!r&&" | ",!!m&&n.createElement("span",{className:"progress-bar__text__delta"},`${m}${a}`)))};R.propTypes={progress:s().number.isRequired,onlyDelta:s().bool,unit:s().string,max:s().number.isRequired};const x=R,C=({intervals:e,max:t})=>{const r=Date.now(),a=e.map((({startTime:e,endTime:t})=>(t||r)-e)).reduce(((e,t)=>e+t),0);return C.propTypes={intervals:p.FC.isRequired,max:s().number.isRequired},C.displayName=b(x),n.createElement(x,{progress:(0,u.pD)(a),max:t})},P=y(g)(C);var I=r(6402),M=r(6739);const S=({hoursPerWeek:e,monthIntervals:t,timestamp:r})=>{const a=(0,u.jw)(r),s={startTime:a.startTime,endTime:Date.now()},i=(0,M.kB)(t)/u.ml,o=e/5*(0,u.l5)(a),l=e/5*(0,u.l5)(s);return n.createElement("div",{className:"month-stats"},n.createElement("h3",{className:"month-stats__heading"},"Månad"),n.createElement(x,{progress:i,max:o}),n.createElement("h3",{className:"month-stats__heading"},"Flex"),n.createElement(x,{progress:i,max:l,unit:"h",onlyDelta:!0}))};S.defaultProps={hoursPerWeek:40},S.propTypes={monthIntervals:p.FC.isRequired,hoursPerWeek:s().number,timestamp:s().number.isRequired};const q=S,W=e=>(0,u.u6)(e,{isDuration:!0}),F=({weekday:e,total:t,date:r,intervals:a=[]})=>{const s=10*(0,u.pD)(t),i={height:`${s}px`},o="week-stats-item",l="week-stats-item__bar",m=a.reduce(((e,{timespan:t})=>e+t),0);return n.createElement("div",{className:o},n.createElement("div",{className:l,style:i,tabIndex:"-1","data-testid":"week-stats-item"},a.map((({timespan:e,note:t,notWork:r})=>n.createElement("div",{className:c()(`${l}__item`,{"not-work":r}),key:e},n.createElement("p",{className:`${l}__info`},`${W(e)} ${t}`)))),m>0&&n.createElement("p",{className:`${l}__total`,style:{lineHeight:`${s}px`}},W(m))),n.createElement("p",{className:"week-date"},n.createElement("span",null,e),n.createElement("br",null),n.createElement("span",null,r)))};F.defaultProps={total:0},F.propTypes={weekday:s().string.isRequired,total:s().number,date:s().string.isRequired,intervals:s().arrayOf(s().object)};const A=F;function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class B extends n.Component{constructor(...e){super(...e),L(this,"lastWeek",(()=>{const{fetchIntervalsInWeek:e,timestamp:t}=this.props;e(t-u.un)})),L(this,"nextWeek",(()=>{const{fetchIntervalsInWeek:e,timestamp:t}=this.props;e(t+u.un)}))}render(){const{intervals:e,timestamp:t,userSettings:r}=this.props,a=Date.now(),s=e.map((({startTime:e,endTime:t})=>(t||a)-e)).reduce(((e,t)=>e+t),0);return n.createElement("div",{className:"week-stats"},n.createElement("h3",{className:"week-stats__title"},n.createElement(m.Z,{onClick:this.lastWeek,"data-testid":"prev-week-btn"},"◀︎"),e.length?` v.${(0,u.uW)(t)} `:` v.${(0,u.uW)(a)} `,n.createElement(m.Z,{onClick:this.nextWeek,"data-testid":"next-week-btn"},"▶︎")),n.createElement("div",{className:"week-stats__bars flex-container flex--align-end"},function(e,t){const r=function(e){return e.reduce(((e,{startTime:t,endTime:r,notWork:n,note:a})=>{const s=new Date(t),i=(0,u._3)(s),o=(0,u.FO)(s),l=(r||Date.now())-t,c=e[i]||{total:0,weekDay:o,intervals:[]};return Z(Z({},e),{},{[i]:Z(Z({},c),{},{notWork:n||c.notWork,total:c.total+l,intervals:[...c.intervals,{notWork:n,timespan:l,note:a}]})})}),{})}(e);return(0,u.BN)(t).map((e=>Z(Z({},e),{},{total:0},r[e.date]))).filter((e=>!e.isWeekEnd||0!==e.total))}(e,t).map((e=>n.createElement(A,U({key:e.weekday},e))))),n.createElement(x,{progress:(0,u.pD)(s),max:r.hoursInWeek}))}}B.propTypes={fetchIntervalsInWeek:p.ZP.func.isRequired,intervals:p.FC.isRequired,userSettings:p.AQ.isRequired,timestamp:p.ZP.number.isRequired};const z=y(g)(B);var V=r(7160),H=r(7615),G=r(1138);const Q=({className:e,size:t=30})=>n.createElement("svg",{style:{width:t},className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"30 25 40 45"},n.createElement("path",{d:"M42 31v10a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V31a1 1 0 0 1 1-1h2.586a1 1 0 0 1 .707.293l7.414 7.414a1 1 0 0 1 .293.707V69a1 1 0 0 1-1 1H31a1 1 0 0 1-1-1V31a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1zm9-1h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1zM34 47v18a1 1 0 0 0 1 1h30a1 1 0 0 0 1-1V47a1 1 0 0 0-1-1H35a1 1 0 0 0-1 1z",fillRule:"evenodd"}));Q.propTypes={size:s().number,className:s().string};const Y=(0,G.Z)(Q);var J=r(3379),K=r.n(J),X=r(9901),ee={insert:"head",singleton:!1};K()(X.Z,ee);const te=X.Z.locals||{},re=({error:e})=>n.createElement("div",{className:te.errorMsg},"⚠️ ",e);re.propTypes={error:s().string.isRequired};const ne=re;function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function se(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const ie=()=>{},oe=e=>{let{notes:t,onCancel:r,onAdd:a,fullDay:s}=e,i=se(e,["notes","onCancel","onAdd","fullDay"]);const o=parseInt(s,10),l=Math.round(60*(s-o)),[c,p]=(0,n.useState)(null),[u,d]=(0,n.useState)({startTime:le(9),endTime:le(9+o,l),note:""}),h=e=>{e.preventDefault(),a(u).then((()=>p(null))).catch(p)};return n.createElement(n.Fragment,null,n.createElement("form",ae({},i,{className:"add-one-interval",onSubmit:h}),n.createElement(H.Z,{className:"add-one-interval__interval-list-item",interval:u,onUpdate:e=>{d(e)},onDelete:ie,notes:t}),n.createElement(m.Z,{"data-testid":"add-one-interval-save-btn",type:"submit",theme:"primary",onClick:h,className:"add-one-interval__btn"},n.createElement(Y,{size:17})),n.createElement(m.Z,{"data-testid":"add-one-interval-cancel-btn",theme:"secondary",className:"add-one-interval__btn",onClick:r},"✖")),c&&n.createElement(ne,{error:c}))};function le(e,t=0,r=0){const n=new Date;return n.setHours(e),n.setMinutes(t),n.setSeconds(r),n.getTime()}oe.propTypes={onAdd:s().func.isRequired,onCancel:s().func.isRequired,fullDay:s().number.isRequired,notes:s().arrayOf(s().string)};const ce=oe;var me=r(6504);function pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(r),!0).forEach((function(t){de(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class he extends n.Component{constructor(...e){super(...e),de(this,"state",{displayAddForm:!1}),de(this,"updateTimestamp",(e=>{this.props.updateTimestamp(e)})),de(this,"onDelete",(e=>this.props.attemptRemove(e))),de(this,"onUpdate",(e=>this.props.attemptUpdate(e))),de(this,"onClick",(()=>{const{activeInterval:e,attemptUpdate:t}=this.props;if(e){return t(ue(ue({},e),{},{endTime:Date.now()}))}return t({startTime:Date.now()})})),de(this,"onAddPrevClick",(()=>this.setState({displayAddForm:!0}))),de(this,"onCancelPrevClick",(()=>this.setState({displayAddForm:!1}))),de(this,"onAddOneInterval",(e=>{const{attemptUpdate:t}=this.props;return t(e).then((()=>{this.setState({displayAddForm:!1})}))}))}render(){const{isLoading:e,intervals:t,activeInterval:r,todaysIntervals:a,userSettings:s,timestamp:i,notes:l}=this.props,{displayAddForm:c}=this.state,p=r?[].concat(r,a):a,d=s.hoursInWeek||40,h=d/5,f=(0,M.kB)(a),b=(0,u.Qk)(i),g=(0,u.jw)(i),y=t.filter((({startTime:e})=>e>b.startTime&&e<b.endTime)),k=t.filter((({startTime:e})=>e>g.startTime&&e<g.endTime));return n.createElement("div",{className:"current-intervals"},n.createElement(o.SV,{fallback:me.l},n.createElement(n.Fragment,null,n.createElement(O,{elapsed:f,from:r?r.startTime:0}),n.createElement(P,{intervals:p,max:d/5}),n.createElement("div",{className:"action-buttons",style:{display:"flex"}},n.createElement(N,{"data-testid":"work-button",activeInterval:!!r,onClick:this.onClick,isLoading:e}),n.createElement(m.Z,{className:"current-intervals__prev-work-btn","data-testid":"register-previous-work-button",theme:"primary",onClick:this.onAddPrevClick},"Efterregga")),c&&n.createElement(ce,{"data-testid":"add-previous-interval-form",onAdd:this.onAddOneInterval,onCancel:this.onCancelPrevClick,fullDay:h,notes:l}),n.createElement(I.Z,{"data-testid":"current-intervals-list",intervals:p,onDelete:this.onDelete,onUpdate:this.onUpdate,notes:l}),n.createElement(z,{fetchIntervalsInWeek:this.updateTimestamp,intervals:y,timestamp:i,userSettings:s}),t.length>0&&n.createElement(q,{timestamp:i,monthIntervals:k,hoursPerWeek:s.hoursInWeek}),s.displayMonthReport&&n.createElement(v,{intervals:t}))))}}he.propTypes=ue(ue({},he.propTypes),{},{isLoading:s().bool,activeInterval:p.FG,intervals:p.FC.isRequired,todaysIntervals:p.FC.isRequired,attemptUpdate:s().func.isRequired,attemptRemove:s().func.isRequired,updateTimestamp:s().func.isRequired,timestamp:s().number.isRequired,notes:s().arrayOf(s().string)}),he.defaultProps={activeInterval:null};const fe=(0,u.PE)(Date.now());function ve({startTime:e,endTime:t}){const r=e>fe.startTime,n=t>fe.startTime&&t<fe.endTime;return r||n}const be=(0,i.$j)((function({intervals:{items:e,timestamp:t,isFetching:r,isSaving:n},userSettings:a}){const s=e.map((({note:e})=>e?e.toLowerCase():e)).filter((e=>e));return{timestamp:t,isLoading:r||n,intervals:e,todaysIntervals:e.filter(ve).filter(M.ew),activeInterval:e.find(M.zh),userSettings:a,notes:[...new Set(s)]}}),V)(he)},3635:e=>{e.exports=e=>{"Notification"in window!=!1&&Notification.requestPermission((t=>{if("granted"===t){const t=(r="tajmr",new Notification(r,{body:e,icon:"icons/apple-touch-icon.png",tag:r}));setTimeout((()=>{t.close()}),5e3)}var r}))}},9901:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(3645),a=r.n(n)()((function(e){return e[1]}));a.push([e.id,"._20p0aeUcwUTS4FgkD9la3A {\n  background: var(--danger-color);\n  border-color: var(--danger-color-dark);\n  font-size: smaller;\n  display: flex;\n  justify-content: center;\n  padding: 0.5em;\n}\n",""]),a.locals={errorMsg:"_20p0aeUcwUTS4FgkD9la3A"};const s=a}}]);