(globalThis.webpackChunktajmr=globalThis.webpackChunktajmr||[]).push([[389],{2830:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ce});var n=r(7294),s=r(5697),a=r.n(s),i=r(7703),o=r(8391),l=r(4184),c=r.n(l),m=r(5615),p=r(1657),u=r(9859);function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const h="notwork";class v extends n.Component{constructor(...e){super(...e),d(this,"state",{referenceDate:new Date,filterOut:[]}),d(this,"toggleFilter",(e=>{this.state.filterOut.includes(e)?this.setState((t=>({filterOut:t.filterOut.filter((t=>t!==e))}))):this.setState((t=>({filterOut:[...t.filterOut,e]})))})),d(this,"lastMonth",(()=>{const{referenceDate:e}=this.state,t=new Date(e);t.setMonth(e.getMonth()-1),this.setState({referenceDate:t})})),d(this,"nextMonth",(()=>{const{referenceDate:e}=this.state,t=new Date(e);t.setMonth(e.getMonth()+1),this.setState({referenceDate:t})})),d(this,"getGroupedIntervalsBy",(e=>this.getMonthIntervals().reduce(((t,r)=>{let n=r[e]?r[e].toLowerCase():"-";return r.notWork&&(n=`notwork:${n}`),t[n]||(t[n]=0),t[n]+=(r.endTime||Date.now())-r.startTime,t}),{}))),d(this,"getMonthIntervals",(()=>{const{referenceDate:e}=this.state,{intervals:t}=this.props,{startTime:r,endTime:n}=(0,u.jw)(e);return t.filter((e=>e.startTime>r&&e.startTime<=n))}))}render(){const{referenceDate:e,filterOut:t}=this.state,{className:r}=this.props,s=this.getGroupedIntervalsBy("note"),a=Object.keys(s).map((e=>e.toLowerCase())),i=a.filter((e=>!t.includes(e))),o=i.reduce(((e,t)=>e+s[t]),0);return n.createElement("div",{className:c()("MonthReport",r)},n.createElement("h2",{className:"MonthReport__title"},"Månadssammanställning"),n.createElement("h3",{className:"MonthReport__subtitle"},n.createElement(m.Z,{onClick:this.lastMonth},"◀︎"),`${u.e7[e.getMonth()]} ${e.getFullYear()}`,n.createElement(m.Z,{onClick:this.nextMonth},"▶︎")),n.createElement("div",{className:"MonthReport__filters"},a.map((e=>n.createElement(m.Z,{className:c()("MonthReport__filter",{"MonthReport__filter--active":i.includes(e)}),key:e,onClick:()=>this.toggleFilter(e)},e)))),n.createElement("ul",{className:"MonthReport__list"},i.map((e=>n.createElement("li",{key:e,className:c()("MonthReport__list-item",{"not-work":e.startsWith(h)})},n.createElement("p",{className:"MonthReport__list-item__title"},e),n.createElement("p",{className:"MonthReport__list-item__value"},`${(0,u.pD)(s[e]).toFixed(1)}h`)))),n.createElement("li",{className:"MonthReport__list-item"},n.createElement("p",{className:"MonthReport__list-item__title"},"TOTAL:"),n.createElement("p",{className:"MonthReport__list-item__value"},`${(0,u.pD)(o).toFixed(1)}h`))))}}v.propTypes={className:a().string,intervals:p.FC.isRequired};const f=v;function b(e){return e.displayName||e.name||"Component"}const g=3e4;function y(e){if(!e||"number"!=typeof e)throw Error("Argument for render interval must be number");return t=>{class r extends n.Component{componentDidMount(){this.intervalId=setInterval((()=>{this.forceUpdate()}),e)}componentWillUnmount(){clearInterval(this.intervalId)}render(){return n.createElement(t,this.props)}}return r.getDisplayName=b(t),r}}var k=r(3635),E=r.n(k);const w=({from:e,elapsed:t})=>{const r=e?Date.now()-e+t:t,{hours:s,minutes:a}=(0,u.Ds)(r),i=(0,u.u6)(r,{isDuration:!0});return e&&s&&0===a&&E()(`Nu har du jobbat i ${s} timmar.`),n.createElement("div",{className:"digital-clock"},n.createElement("time",null,i))};w.propTypes={elapsed:a().number.isRequired,from:a().number.isRequired};const _=y(g)(w);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function T(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}const D=e=>{let{isLoading:t=!1,activeInterval:r,onClick:s}=e,a=T(e,["isLoading","activeInterval","onClick"]);const i=r?"Ta en fika ▐▐":"Börja debitera ▶";return n.createElement(m.Z,O({},a,{theme:"primary",className:"work-button",onClick:s,text:i,disabled:t}))};D.propTypes={activeInterval:a().bool.isRequired,onClick:a().func.isRequired,isLoading:a().bool};const N=D;function j(e){return Math.round(10*e)/10}const R=({progress:e,max:t,onlyDelta:r,unit:s=""})=>{const a=(e/t).toFixed(2),i=a>1,o=i?1/a*100+"%":100*a+"%",l=i?100*(1-1/a)+"%":100*(1-a)+"%",m=j(Math.abs(t-e)),p=c()("progress-bar",{"progress-bar--only-delta":r}),u=[e,t].map(j).join(" / ");return n.createElement("div",{className:p},n.createElement("div",{style:{flexBasis:o},className:"progress-bar__progress"}),n.createElement("div",{style:{flexBasis:l},className:c()("progress-bar__rest",{"progress-bar__overtime":i})}),n.createElement("div",{className:"progress-bar__text"},n.createElement("span",{className:"progress-bar__text__progress"},u),!!m&&!r&&" | ",!!m&&n.createElement("span",{className:"progress-bar__text__delta"},`${m}${s}`)))};R.propTypes={progress:a().number.isRequired,onlyDelta:a().bool,unit:a().string,max:a().number.isRequired};const C=R,x=({intervals:e,max:t})=>{const r=Date.now(),s=e.map((({startTime:e,endTime:t})=>(t||r)-e)).reduce(((e,t)=>e+t),0);return x.propTypes={intervals:p.FC.isRequired,max:a().number.isRequired},x.displayName=b(C),n.createElement(C,{progress:(0,u.pD)(s),max:t})},I=y(g)(x);var P=r(6402),M=r(6739);const q=({hoursPerWeek:e,monthIntervals:t,timestamp:r})=>{const s=(0,u.jw)(r),a={startTime:s.startTime,endTime:Date.now()},i=(0,M.kB)(t)/u.ml,o=e/5*(0,u.l5)(s),l=e/5*(0,u.l5)(a);return n.createElement("div",{className:"month-stats"},n.createElement("h3",{className:"month-stats__heading"},"Månad"),n.createElement(C,{progress:i,max:o}),n.createElement("h3",{className:"month-stats__heading"},"Flex"),n.createElement(C,{progress:i,max:l,unit:"h",onlyDelta:!0}))};q.defaultProps={hoursPerWeek:40},q.propTypes={monthIntervals:p.FC.isRequired,hoursPerWeek:a().number,timestamp:a().number.isRequired};const W=q,S=e=>(0,u.u6)(e,{isDuration:!0}),F=({weekday:e,total:t,date:r,intervals:s=[]})=>{const a=10*(0,u.pD)(t),i={height:`${a}px`},o="week-stats-item",l="week-stats-item__bar",m=s.reduce(((e,{timespan:t})=>e+t),0);return n.createElement("div",{className:o},n.createElement("div",{className:l,style:i,tabIndex:"-1","data-testid":"week-stats-item"},s.map((({timespan:e,note:t,notWork:r})=>n.createElement("div",{className:c()(`${l}__item`,{"not-work":r}),key:e},n.createElement("p",{className:`${l}__info`},`${S(e)} ${t}`)))),m>0&&n.createElement("p",{className:`${l}__total`,style:{lineHeight:`${a}px`}},S(m))),n.createElement("p",{className:"week-date"},n.createElement("span",null,e),n.createElement("br",null),n.createElement("span",null,r)))};F.defaultProps={total:0},F.propTypes={weekday:a().string.isRequired,total:a().number,date:a().string.isRequired,intervals:a().arrayOf(a().object)};const A=F;function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class B extends n.Component{constructor(...e){super(...e),L(this,"lastWeek",(()=>{const{fetchIntervalsInWeek:e,timestamp:t}=this.props;e(t-u.un)})),L(this,"nextWeek",(()=>{const{fetchIntervalsInWeek:e,timestamp:t}=this.props;e(t+u.un)}))}render(){const{intervals:e,timestamp:t,userSettings:r}=this.props,s=Date.now(),a=e.map((({startTime:e,endTime:t})=>(t||s)-e)).reduce(((e,t)=>e+t),0);return n.createElement("div",{className:"week-stats"},n.createElement("h3",{className:"week-stats__title"},n.createElement(m.Z,{onClick:this.lastWeek,"data-testid":"prev-week-btn"},"◀︎"),e.length?` v.${(0,u.uW)(t)} `:` v.${(0,u.uW)(s)} `,n.createElement(m.Z,{onClick:this.nextWeek,"data-testid":"next-week-btn"},"▶︎")),n.createElement("div",{className:"week-stats__bars flex-container flex--align-end"},function(e,t){const r=function(e){return e.reduce(((e,{startTime:t,endTime:r,notWork:n,note:s})=>{const a=new Date(t),i=(0,u._3)(a),o=(0,u.FO)(a),l=(r||Date.now())-t,c=e[i]||{total:0,weekDay:o,intervals:[]};return Z(Z({},e),{},{[i]:Z(Z({},c),{},{notWork:n||c.notWork,total:c.total+l,intervals:[...c.intervals,{notWork:n,timespan:l,note:s}]})})}),{})}(e);return(0,u.BN)(t).map((e=>Z(Z({},e),{},{total:0},r[e.date]))).filter((e=>!e.isWeekEnd||0!==e.total))}(e,t).map((e=>n.createElement(A,U({key:e.weekday},e))))),n.createElement(C,{progress:(0,u.pD)(a),max:r.hoursInWeek}))}}B.propTypes={fetchIntervalsInWeek:p.ZP.func.isRequired,intervals:p.FC.isRequired,userSettings:p.AQ.isRequired,timestamp:p.ZP.number.isRequired};const z=y(g)(B);var V=r(7160),H=r(7615),G=r(1138);const Q=({className:e,size:t=30})=>n.createElement("svg",{style:{width:t},className:e,xmlns:"http://www.w3.org/2000/svg",viewBox:"30 25 40 45"},n.createElement("path",{d:"M42 31v10a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1V31a1 1 0 0 1 1-1h2.586a1 1 0 0 1 .707.293l7.414 7.414a1 1 0 0 1 .293.707V69a1 1 0 0 1-1 1H31a1 1 0 0 1-1-1V31a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1zm9-1h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1zM34 47v18a1 1 0 0 0 1 1h30a1 1 0 0 0 1-1V47a1 1 0 0 0-1-1H35a1 1 0 0 0-1 1z",fillRule:"evenodd"}));Q.propTypes={size:a().number,className:a().string};const Y=(0,G.Z)(Q);function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class K extends n.Component{constructor(e){super(e),J(this,"onAdd",(e=>{e.preventDefault(),this.props.onAdd(this.state.interval)})),J(this,"onCancel",(()=>{})),J(this,"onUpdate",(e=>{this.setState({interval:e})}));const t=parseInt(e.fullDay,10),r=Math.round(60*(e.fullDay-t));this.state={interval:{startTime:ee(9),endTime:ee(9+t,r),note:""}}}render(){const{interval:e}=this.state,{notes:t,onCancel:r}=this.props;return n.createElement("form",{className:"add-one-interval",onSubmit:this.onAdd},n.createElement(H.Z,{className:"add-one-interval__interval-list-item",interval:e,onUpdate:this.onUpdate,onDelete:X,notes:t}),n.createElement(m.Z,{type:"submit",theme:"primary",onClick:this.onAdd,className:"add-one-interval__btn"},n.createElement(Y,{size:17})),n.createElement(m.Z,{theme:"secondary",className:"add-one-interval__btn",onClick:r},"✖"))}}function X(){}function ee(e,t=0,r=0){const n=new Date;return n.setHours(e),n.setMinutes(t),n.setSeconds(r),n.getTime()}K.propTypes={onAdd:a().func.isRequired,onCancel:a().func.isRequired,fullDay:a().number.isRequired,notes:a().arrayOf(a().string)};const te=K;var re=r(6504);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){ae(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ie extends n.Component{constructor(...e){super(...e),ae(this,"state",{displayAddForm:!1}),ae(this,"updateTimestamp",(e=>{this.props.updateTimestamp(e)})),ae(this,"onDelete",(e=>this.props.attemptRemove(e))),ae(this,"onUpdate",(e=>this.props.attemptUpdate(e))),ae(this,"onClick",(()=>{const{activeInterval:e,attemptUpdate:t}=this.props;if(e){return t(se(se({},e),{},{endTime:Date.now()}))}return t({startTime:Date.now()})})),ae(this,"onAddPrevClick",(()=>this.setState({displayAddForm:!0}))),ae(this,"onCancelPrevClick",(()=>this.setState({displayAddForm:!1}))),ae(this,"onAddOneInterval",(e=>{const{attemptUpdate:t,intervalAdded:r}=this.props;t(e).then((e=>{this.setState({displayAddForm:!1}),r(e)}))}))}render(){const{isLoading:e,intervals:t,activeInterval:r,todaysIntervals:s,userSettings:a,timestamp:i,notes:l}=this.props,{displayAddForm:c}=this.state,p=r?[].concat(r,s):s,d=a.hoursInWeek||40,h=d/5,v=(0,M.kB)(s),b=(0,u.Qk)(i),g=(0,u.jw)(i),y=t.filter((({startTime:e})=>e>b.startTime&&e<b.endTime)),k=t.filter((({startTime:e})=>e>g.startTime&&e<g.endTime));return n.createElement("div",{className:"current-intervals"},n.createElement(o.SV,{fallback:re.l},n.createElement(n.Fragment,null,n.createElement(_,{elapsed:v,from:r?r.startTime:0}),n.createElement(I,{intervals:p,max:d/5}),n.createElement("div",{className:"action-buttons",style:{display:"flex"}},n.createElement(N,{"data-testid":"work-button",activeInterval:!!r,onClick:this.onClick,isLoading:e}),n.createElement(m.Z,{className:"current-intervals__prev-work-btn",theme:"primary",onClick:this.onAddPrevClick},"Efterregga")),c&&n.createElement(te,{onAdd:this.onAddOneInterval,onCancel:this.onCancelPrevClick,fullDay:h,notes:l}),n.createElement(P.Z,{"data-testid":"current-intervals-list",intervals:p,onDelete:this.onDelete,onUpdate:this.onUpdate,notes:l}),n.createElement(z,{fetchIntervalsInWeek:this.updateTimestamp,intervals:y,timestamp:i,userSettings:a}),t.length>0&&n.createElement(W,{timestamp:i,monthIntervals:k,hoursPerWeek:a.hoursInWeek}),a.displayMonthReport&&n.createElement(f,{intervals:t}))))}}ie.propTypes=se(se({},ie.propTypes),{},{isLoading:a().bool,activeInterval:p.FG,intervals:p.FC.isRequired,todaysIntervals:p.FC.isRequired,attemptUpdate:a().func.isRequired,attemptRemove:a().func.isRequired,updateTimestamp:a().func.isRequired,timestamp:a().number.isRequired,notes:a().arrayOf(a().string)}),ie.defaultProps={activeInterval:null};const oe=(0,u.PE)(Date.now());function le({startTime:e,endTime:t}){const r=e>oe.startTime,n=t>oe.startTime&&t<oe.endTime;return r||n}const ce=(0,i.$j)((function({intervals:{items:e,timestamp:t,isFetching:r,isSaving:n},userSettings:s}){const a=e.map((({note:e})=>e?e.toLowerCase():e)).filter((e=>e));return{timestamp:t,isLoading:r||n,intervals:e,todaysIntervals:e.filter(le).filter(M.ew),activeInterval:e.find(M.zh),userSettings:s,notes:[...new Set(a)]}}),V)(ie)},3635:e=>{e.exports=e=>{"Notification"in window!=!1&&Notification.requestPermission((t=>{if("granted"===t){const t=(r="tajmr",new Notification(r,{body:e,icon:"icons/apple-touch-icon.png",tag:r}));setTimeout((()=>{t.close()}),5e3)}var r}))}}}]);